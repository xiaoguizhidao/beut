var Opentip,firstAdapter,i,mouseMoved,mousePosition,mousePositionObservers,position,vendors,_i,_len,_ref,__slice=[].slice,__indexOf=[].indexOf||function(c){for(var a=0,b=this.length;b>a;a++)if(a in this&&this[a]===c)return a;return-1},__hasProp={}.hasOwnProperty;
Opentip=function(){function c(a,b,e,d){var k,h,f,g,m=this;if(this.id=++c.lastId,this.debug("Creating Opentip."),c.tips.push(this),this.adapter=c.adapter,k=this.adapter.data(a,"opentips")||[],k.push(this),this.adapter.data(a,"opentips",k),this.triggerElement=this.adapter.wrap(a),1<this.triggerElement.length)throw Error("You can't call Opentip on multiple elements.");if(1>this.triggerElement.length)throw Error("Invalid element.");this.waitingToHide=this.waitingToShow=this.visible=this.loading=this.loaded=
!1;this.currentPosition={left:0,top:0};this.dimensions={width:100,height:50};this.content="";this.redraw=!0;this.currentObservers={showing:!1,visible:!1,hiding:!1,hidden:!1};d=this.adapter.clone(d);"object"==typeof b?(d=b,b=e=void 0):"object"==typeof e&&(d=e,e=void 0);null!=e&&(d.title=e);null!=b&&this.setContent(b);null==d["extends"]&&(d["extends"]=null!=d.style?d.style:c.defaultStyle);a=[d];for(b=d;b["extends"];){if(f=b["extends"],b=c.styles[f],null==b)throw Error("Invalid style: "+f);a.unshift(b);
null==b["extends"]&&"standard"!==f&&(b["extends"]="standard")}d=(g=this.adapter).extend.apply(g,[{}].concat(__slice.call(a)));d.hideTriggers=function(){var a,b,e,c;e=d.hideTriggers;c=[];a=0;for(b=e.length;b>a;a++)h=e[a],c.push(h);return c}();d.hideTrigger&&0===d.hideTriggers.length&&d.hideTriggers.push(d.hideTrigger);b=["tipJoint","targetJoint","stem"];g=0;for(a=b.length;a>g;g++)f=b[g],d[f]&&"string"==typeof d[f]&&(d[f]=new c.Joint(d[f]));!d.ajax||!0!==d.ajax&&d.ajax||(d.ajax="A"===this.adapter.tagName(this.triggerElement)?
this.adapter.attr(this.triggerElement,"href"):!1);"click"===d.showOn&&"A"===this.adapter.tagName(this.triggerElement)&&this.adapter.observe(this.triggerElement,"click",function(a){return a.preventDefault(),a.stopPropagation(),a.stopped=!0});d.target&&(d.fixed=!0);!0===d.stem&&(d.stem=new c.Joint(d.tipJoint));!0===d.target?d.target=this.triggerElement:d.target&&(d.target=this.adapter.wrap(d.target));this.currentStem=d.stem;null==d.delay&&(d.delay="mouseover"===d.showOn?0.2:0);null==d.targetJoint&&
(d.targetJoint=(new c.Joint(d.tipJoint)).flip());this.showTriggers=[];this.showTriggersWhenVisible=[];this.hideTriggers=[];d.showOn&&"creation"!==d.showOn&&this.showTriggers.push({element:this.triggerElement,event:d.showOn});null!=d.ajaxCache&&(d.cache=d.ajaxCache,delete d.ajaxCache);this.options=d;this.bound={};b=["prepareToShow","prepareToHide","show","hide","reposition"];g=0;for(a=b.length;a>g;g++)f=b[g],this.bound[f]=function(a){return function(){return m[a].apply(m,arguments)}}(f);this.adapter.domReady(function(){return m.activate(),
"creation"===m.options.showOn?m.prepareToShow():void 0})}return c.prototype.STICKS_OUT_TOP=1,c.prototype.STICKS_OUT_BOTTOM=2,c.prototype.STICKS_OUT_LEFT=1,c.prototype.STICKS_OUT_RIGHT=2,c.prototype["class"]={container:"opentip-container",opentip:"opentip",header:"ot-header",content:"ot-content",loadingIndicator:"ot-loading-indicator",close:"ot-close",goingToHide:"ot-going-to-hide",hidden:"ot-hidden",hiding:"ot-hiding",goingToShow:"ot-going-to-show",showing:"ot-showing",visible:"ot-visible",loading:"ot-loading",
ajaxError:"ot-ajax-error",fixed:"ot-fixed",showEffectPrefix:"ot-show-effect-",hideEffectPrefix:"ot-hide-effect-",stylePrefix:"style-"},c.prototype._setup=function(){var a,b,e,d,c,h;this.debug("Setting up the tooltip.");this._buildContainer();this.hideTriggers=[];h=this.options.hideTriggers;a=d=0;for(c=h.length;c>d;a=++d){if(b=h[a],e=null,a=this.options.hideOn instanceof Array?this.options.hideOn[a]:this.options.hideOn,"string"==typeof b)switch(b){case "trigger":a=a||"mouseout";e=this.triggerElement;
break;case "tip":a=a||"mouseover";e=this.container;break;case "target":a=a||"mouseover";e=this.options.target;break;case "closeButton":break;default:throw Error("Unknown hide trigger: "+b+".");}else a=a||"mouseover",e=this.adapter.wrap(b);e&&this.hideTriggers.push({element:e,event:a,original:b})}c=this.hideTriggers;h=[];e=0;for(d=c.length;d>e;e++)b=c[e],h.push(this.showTriggersWhenVisible.push({element:b.element,event:"mouseover"}));return h},c.prototype._buildContainer=function(){return this.container=
this.adapter.create('<div id="opentip-'+this.id+'" class="'+this["class"].container+" "+this["class"].hidden+" "+this["class"].stylePrefix+this.options.className+'"></div>'),this.adapter.css(this.container,{position:"absolute"}),this.options.ajax&&this.adapter.addClass(this.container,this["class"].loading),this.options.fixed&&this.adapter.addClass(this.container,this["class"].fixed),this.options.showEffect&&this.adapter.addClass(this.container,""+this["class"].showEffectPrefix+this.options.showEffect),
this.options.hideEffect?this.adapter.addClass(this.container,""+this["class"].hideEffectPrefix+this.options.hideEffect):void 0},c.prototype._buildElements=function(){var a,b;return this.tooltipElement=this.adapter.create('<div class="'+this["class"].opentip+'"><div class="'+this["class"].header+'"></div><div class="'+this["class"].content+'"></div></div>'),this.backgroundCanvas=this.adapter.wrap(document.createElement("canvas")),this.adapter.css(this.backgroundCanvas,{position:"absolute"}),"undefined"!=
typeof G_vmlCanvasManager&&null!==G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.adapter.unwrap(this.backgroundCanvas)),a=this.adapter.find(this.tooltipElement,"."+this["class"].header),this.options.title&&(b=this.adapter.create("<h1></h1>"),this.adapter.update(b,this.options.title,this.options.escapeTitle),this.adapter.append(a,b)),this.options.ajax&&!this.loaded&&this.adapter.append(this.tooltipElement,this.adapter.create('<div class="'+this["class"].loadingIndicator+'"><span>\u21bb</span></div>')),
0<=__indexOf.call(this.options.hideTriggers,"closeButton")&&(this.closeButtonElement=this.adapter.create('<a href="javascript:undefined;" class="'+this["class"].close+'"><span>Close</span></a>'),this.adapter.append(a,this.closeButtonElement)),this.adapter.append(this.container,this.backgroundCanvas),this.adapter.append(this.container,this.tooltipElement),this.adapter.append(document.body,this.container),this._newContent=!0,this.redraw=!0},c.prototype.setContent=function(a){return this.content=a,this._newContent=
!0,"function"==typeof this.content?(this._contentFunction=this.content,this.content=""):this._contentFunction=null,this.visible?this._updateElementContent():void 0},c.prototype._updateElementContent=function(){var a;return(this._newContent||!this.options.cache&&this._contentFunction)&&(a=this.adapter.find(this.container,"."+this["class"].content),null!=a&&(this._contentFunction&&(this.debug("Executing content function."),this.content=this._contentFunction(this)),this.adapter.update(a,this.content,
this.options.escapeContent)),this._newContent=!1),this._storeAndLockDimensions(),this.reposition()},c.prototype._storeAndLockDimensions=function(){var a;if(this.container)return a=this.dimensions,this.adapter.css(this.container,{width:"auto",left:"0px",top:"0px"}),this.dimensions=this.adapter.dimensions(this.container),this.dimensions.width+=1,this.adapter.css(this.container,{width:""+this.dimensions.width+"px",top:""+this.currentPosition.top+"px",left:""+this.currentPosition.left+"px"}),this._dimensionsEqual(this.dimensions,
a)?void 0:(this.redraw=!0,this._draw())},c.prototype.activate=function(){return this._setupObservers("hidden","hiding")},c.prototype.deactivate=function(){return this.debug("Deactivating tooltip."),this.hide(),this._setupObservers("-showing","-visible","-hidden","-hiding")},c.prototype._setupObservers=function(){var a,b,e,d,c,h,f,g,m,n,l=this;d=1<=arguments.length?__slice.call(arguments,0):[];h=0;for(g=d.length;g>h;h++)if(e=d[h],b=!1,"-"===e.charAt(0)&&(b=!0,e=e.substr(1)),this.currentObservers[e]!==
!b)switch(this.currentObservers[e]=!b,a=function(){var a,e,d;return a=1<=arguments.length?__slice.call(arguments,0):[],b?(e=l.adapter).stopObserving.apply(e,a):(d=l.adapter).observe.apply(d,a)},e){case "showing":n=this.hideTriggers;f=0;for(m=n.length;m>f;f++)c=n[f],a(c.element,c.event,this.bound.prepareToHide);a(null!=document.onresize?document:window,"resize",this.bound.reposition);a(window,"scroll",this.bound.reposition);break;case "visible":n=this.showTriggersWhenVisible;f=0;for(m=n.length;m>f;f++)c=
n[f],a(c.element,c.event,this.bound.prepareToShow);break;case "hiding":n=this.showTriggers;f=0;for(m=n.length;m>f;f++)c=n[f],a(c.element,c.event,this.bound.prepareToShow);break;case "hidden":break;default:throw Error("Unknown state: "+e);}return null},c.prototype.prepareToShow=function(){return this._abortHiding(),this._abortShowing(),this.visible?void 0:(this.debug("Showing in "+this.options.delay+"s."),null==this.container&&this._setup(),this.options.group&&c._abortShowingGroup(this.options.group,
this),this.preparingToShow=!0,this._setupObservers("-hidden","-hiding","showing"),this._followMousePosition(),this.options.fixed&&!this.options.target&&(this.initialMousePosition=mousePosition),this.reposition(),this._showTimeoutId=this.setTimeout(this.bound.show,this.options.delay||0))},c.prototype.show=function(){var a=this;return this._abortHiding(),this.visible?void 0:(this._clearTimeouts(),this._triggerElementExists()?(this.debug("Showing now."),null==this.container&&this._setup(),this.options.group&&
c._hideGroup(this.options.group,this),this.visible=!0,this.preparingToShow=!1,null==this.tooltipElement&&this._buildElements(),this._updateElementContent(),!this.options.ajax||this.loaded&&this.options.cache||this._loadAjax(),this._searchAndActivateCloseButtons(),this._startEnsureTriggerElement(),this.adapter.css(this.container,{zIndex:c.lastZIndex++}),this._setupObservers("-hidden","-hiding","-showing","-visible","showing","visible"),this.options.fixed&&!this.options.target&&(this.initialMousePosition=
mousePosition),this.reposition(),this.adapter.removeClass(this.container,this["class"].hiding),this.adapter.removeClass(this.container,this["class"].hidden),this.adapter.addClass(this.container,this["class"].goingToShow),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var b;if(a.visible&&!a.preparingToHide)return a.adapter.removeClass(a.container,a["class"].goingToShow),a.adapter.addClass(a.container,a["class"].showing),b=0,a.options.showEffect&&a.options.showEffectDuration&&
(b=a.options.showEffectDuration),a.setCss3Style(a.container,{transitionDuration:""+b+"s"}),a._visibilityStateTimeoutId=a.setTimeout(function(){return a.adapter.removeClass(a.container,a["class"].showing),a.adapter.addClass(a.container,a["class"].visible)},b),a._activateFirstInput()}),this._draw()):this.deactivate())},c.prototype._abortShowing=function(){return this.preparingToShow?(this.debug("Aborting showing."),this._clearTimeouts(),this._stopFollowingMousePosition(),this.preparingToShow=!1,this._setupObservers("-showing",
"-visible","hiding","hidden")):void 0},c.prototype.prepareToHide=function(){return this._abortShowing(),this._abortHiding(),this.visible?(this.debug("Hiding in "+this.options.hideDelay+"s"),this.preparingToHide=!0,this._setupObservers("-showing","visible","-hidden","hiding"),this._hideTimeoutId=this.setTimeout(this.bound.hide,this.options.hideDelay)):void 0},c.prototype.hide=function(){var a=this;return this._abortShowing(),this.visible&&(this._clearTimeouts(),this.debug("Hiding!"),this.visible=!1,
this.preparingToHide=!1,this._stopEnsureTriggerElement(),this._setupObservers("-showing","-visible","-hiding","-hidden","hiding","hidden"),this.options.fixed||this._stopFollowingMousePosition(),this.container)?(this.adapter.removeClass(this.container,this["class"].visible),this.adapter.removeClass(this.container,this["class"].showing),this.adapter.addClass(this.container,this["class"].goingToHide),this.setCss3Style(this.container,{transitionDuration:"0s"}),this.defer(function(){var b;return a.adapter.removeClass(a.container,
a["class"].goingToHide),a.adapter.addClass(a.container,a["class"].hiding),b=0,a.options.hideEffect&&a.options.hideEffectDuration&&(b=a.options.hideEffectDuration),a.setCss3Style(a.container,{transitionDuration:""+b+"s"}),a._visibilityStateTimeoutId=a.setTimeout(function(){return a.adapter.removeClass(a.container,a["class"].hiding),a.adapter.addClass(a.container,a["class"].hidden),a.setCss3Style(a.container,{transitionDuration:"0s"}),a.options.removeElementsOnHide?(a.debug("Removing HTML elements."),
a.adapter.remove(a.container),delete a.container,delete a.tooltipElement):void 0},b)})):void 0},c.prototype._abortHiding=function(){return this.preparingToHide?(this.debug("Aborting hiding."),this._clearTimeouts(),this.preparingToHide=!1,this._setupObservers("-hiding","showing","visible")):void 0},c.prototype.reposition=function(){var a,b,e,d=this;return a=this.getPosition(),null==a||(b=this.options.stem,this.options.containInViewport&&(e=this._ensureViewportContainment(a),a=e.position,b=e.stem),
this._positionsEqual(a,this.currentPosition))?void 0:(this.options.stem&&!b.eql(this.currentStem)&&(this.redraw=!0),this.currentPosition=a,this.currentStem=b,this._draw(),this.adapter.css(this.container,{left:""+a.left+"px",top:""+a.top+"px"}),this.defer(function(){var a;return a=d.adapter.unwrap(d.container),a.style.visibility="hidden",a.style.visibility="visible"}))},c.prototype.getPosition=function(a,b,e){var d,c,h,f,g,m,n,l,r;if(this.container)return null==a&&(a=this.options.tipJoint),null==b&&
(b=this.options.targetJoint),this.options.target?(n=this.adapter.offset(this.options.target),m=this.adapter.dimensions(this.options.target),f=n,b.right?(l=this.adapter.unwrap(this.options.target),null!=l.getBoundingClientRect?f.left=l.getBoundingClientRect().right+(null!=(r=window.pageXOffset)?r:document.body.scrollLeft):f.left+=m.width):b.center&&(f.left+=Math.round(m.width/2)),b.bottom?f.top+=m.height:b.middle&&(f.top+=Math.round(m.height/2)),this.options.borderWidth&&(this.options.tipJoint.left&&
(f.left+=this.options.borderWidth),this.options.tipJoint.right&&(f.left-=this.options.borderWidth),this.options.tipJoint.top?f.top+=this.options.borderWidth:this.options.tipJoint.bottom&&(f.top-=this.options.borderWidth))):f=this.initialMousePosition?{top:this.initialMousePosition.y,left:this.initialMousePosition.x}:{top:mousePosition.y,left:mousePosition.x},this.options.autoOffset&&(g=this.options.stem?this.options.stemLength:0,h=g&&this.options.fixed?2:10,d=a.middle&&!this.options.fixed?15:0,c=
a.center&&!this.options.fixed?15:0,a.right?f.left-=h+d:a.left&&(f.left+=h+d),a.bottom?f.top-=h+c:a.top&&(f.top+=h+c),g&&(null==e&&(e=this.options.stem),e.right?f.left-=g:e.left&&(f.left+=g),e.bottom?f.top-=g:e.top&&(f.top+=g))),f.left+=this.options.offset[0],f.top+=this.options.offset[1],a.right?f.left-=this.dimensions.width:a.center&&(f.left-=Math.round(this.dimensions.width/2)),a.bottom?f.top-=this.dimensions.height:a.middle&&(f.top-=Math.round(this.dimensions.height/2)),f},c.prototype._ensureViewportContainment=
function(a){var b,e,d,k,h,f,g,m,n,l;if(!((f=this.options.stem,d={position:a,stem:f},this.visible&&a)&&(g=this._sticksOut(a),g[0]||g[1])))return d;if(n=new c.Joint(this.options.tipJoint),this.options.targetJoint&&(m=new c.Joint(this.options.targetJoint)),this.adapter.scrollOffset(),l=this.adapter.viewportDimensions(),b=!1,l.width>=this.dimensions.width&&g[0])switch(b=!0,g[0]){case this.STICKS_OUT_LEFT:n.setHorizontal("left");this.options.targetJoint&&m.setHorizontal("right");break;case this.STICKS_OUT_RIGHT:n.setHorizontal("right"),
this.options.targetJoint&&m.setHorizontal("left")}if(l.height>=this.dimensions.height&&g[1])switch(b=!0,g[1]){case this.STICKS_OUT_TOP:n.setVertical("top");this.options.targetJoint&&m.setVertical("bottom");break;case this.STICKS_OUT_BOTTOM:n.setVertical("bottom"),this.options.targetJoint&&m.setVertical("top")}return b?(this.options.stem&&(f=n),a=this.getPosition(n,m,f),e=this._sticksOut(a),k=!1,h=!1,e[0]&&e[0]!==g[0]&&(k=!0,n.setHorizontal(this.options.tipJoint.horizontal),this.options.targetJoint&&
m.setHorizontal(this.options.targetJoint.horizontal)),e[1]&&e[1]!==g[1]&&(h=!0,n.setVertical(this.options.tipJoint.vertical),this.options.targetJoint&&m.setVertical(this.options.targetJoint.vertical)),k&&h?d:((k||h)&&(this.options.stem&&(f=n),a=this.getPosition(n,m,f)),{position:a,stem:f})):d},c.prototype._sticksOut=function(a){var b,e,d,c;return e=this.adapter.scrollOffset(),c=this.adapter.viewportDimensions(),b=[a.left-e[0],a.top-e[1]],d=[!1,!1],0>b[0]?d[0]=this.STICKS_OUT_LEFT:b[0]+this.dimensions.width>
c.width&&(d[0]=this.STICKS_OUT_RIGHT),0>b[1]?d[1]=this.STICKS_OUT_TOP:b[1]+this.dimensions.height>c.height&&(d[1]=this.STICKS_OUT_BOTTOM),d},c.prototype._draw=function(){var a,b,e,d,k,h,f,g,m,n,l,r,q,s,t,w,u,x,v,p=this;if(this.backgroundCanvas&&this.redraw){if(this.debug("Drawing background."),this.redraw=!1,this.currentStem){u=["top","right","bottom","left"];t=0;for(w=u.length;w>t;t++)r=u[t],this.adapter.removeClass(this.container,"stem-"+r);this.adapter.addClass(this.container,"stem-"+this.currentStem.horizontal);
this.adapter.addClass(this.container,"stem-"+this.currentStem.vertical)}return h=[0,0],f=[0,0],0<=__indexOf.call(this.options.hideTriggers,"closeButton")&&(k=new c.Joint("top right"===(null!=(x=this.currentStem)?x+"":void 0)?"top left":"top right"),h=[this.options.closeButtonRadius+this.options.closeButtonOffset[0],this.options.closeButtonRadius+this.options.closeButtonOffset[1]],f=[this.options.closeButtonRadius-this.options.closeButtonOffset[0],this.options.closeButtonRadius-this.options.closeButtonOffset[1]]),
e=this.adapter.clone(this.dimensions),d=[0,0],this.options.borderWidth&&(e.width+=2*this.options.borderWidth,e.height+=2*this.options.borderWidth,d[0]-=this.options.borderWidth,d[1]-=this.options.borderWidth),this.options.shadow&&(e.width+=2*this.options.shadowBlur,e.width+=Math.max(0,this.options.shadowOffset[0]-2*this.options.shadowBlur),e.height+=2*this.options.shadowBlur,e.height+=Math.max(0,this.options.shadowOffset[1]-2*this.options.shadowBlur),d[0]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[0]),
d[1]-=Math.max(0,this.options.shadowBlur-this.options.shadowOffset[1])),b={left:0,right:0,top:0,bottom:0},this.currentStem&&(this.currentStem.left?b.left=this.options.stemLength:this.currentStem.right&&(b.right=this.options.stemLength),this.currentStem.top?b.top=this.options.stemLength:this.currentStem.bottom&&(b.bottom=this.options.stemLength)),k&&(k.left?b.left=Math.max(b.left,f[0]):k.right&&(b.right=Math.max(b.right,f[0])),k.top?b.top=Math.max(b.top,f[1]):k.bottom&&(b.bottom=Math.max(b.bottom,
f[1]))),e.width+=b.left+b.right,e.height+=b.top+b.bottom,d[0]-=b.left,d[1]-=b.top,this.currentStem&&this.options.borderWidth&&(v=this._getPathStemMeasures(this.options.stemBase,this.options.stemLength,this.options.borderWidth),s=v.stemLength,q=v.stemBase),a=this.adapter.unwrap(this.backgroundCanvas),a.width=e.width,a.height=e.height,this.adapter.css(this.backgroundCanvas,{width:""+a.width+"px",height:""+a.height+"px",left:""+d[0]+"px",top:""+d[1]+"px"}),g=a.getContext("2d"),g.setTransform(1,0,0,1,
0,0),g.clearRect(0,0,a.width,a.height),g.beginPath(),g.fillStyle=this._getColor(g,this.dimensions,this.options.background,this.options.backgroundGradientHorizontal),g.lineJoin="miter",g.miterLimit=500,l=this.options.borderWidth/2,this.options.borderWidth?(g.strokeStyle=this.options.borderColor,g.lineWidth=this.options.borderWidth):(s=this.options.stemLength,q=this.options.stemBase),null==q&&(q=0),n=function(a,b,e){return e&&g.moveTo(Math.max(q,p.options.borderRadius,h[0])+1-l,-l),b?(g.lineTo(a/2-
q/2,-l),g.lineTo(a/2,-s-l),g.lineTo(a/2+q/2,-l)):void 0},m=function(a,b,e){var d,c,f,k;return a?(g.lineTo(-q+l,0-l),g.lineTo(s+l,-s-l),g.lineTo(l,q-l)):b?(k=p.options.closeButtonOffset,f=h[0],0!==e%2&&(k=[k[1],k[0]],f=h[1]),d=Math.acos(k[1]/p.options.closeButtonRadius),c=Math.acos(k[0]/p.options.closeButtonRadius),g.lineTo(-f+l,-l),g.arc(l-k[0],-l+k[1],p.options.closeButtonRadius,-(Math.PI/2+d),c,!1)):(g.lineTo(-p.options.borderRadius+l,-l),g.quadraticCurveTo(l,-l,l,p.options.borderRadius-l))},g.translate(-d[0],
-d[1]),g.save(),function(){var a,b,e,d,f,h,l,q,r,s;s=[];b=q=0;for(r=c.positions.length/2;0<=r?r>q:q>r;b=0<=r?++q:--q)a=2*b,f=0===b||3===b?0:p.dimensions.width,h=2>b?0:p.dimensions.height,l=Math.PI/2*b,e=0===b%2?p.dimensions.width:p.dimensions.height,d=new c.Joint(c.positions[a]),a=new c.Joint(c.positions[a+1]),g.save(),g.translate(f,h),g.rotate(l),n(e,d.eql(p.currentStem),0===b),g.translate(e,0),m(a.eql(p.currentStem),a.eql(k),b),s.push(g.restore());return s}(),g.closePath(),g.save(),this.options.shadow&&
(g.shadowColor=this.options.shadowColor,g.shadowBlur=this.options.shadowBlur,g.shadowOffsetX=this.options.shadowOffset[0],g.shadowOffsetY=this.options.shadowOffset[1]),g.fill(),g.restore(),this.options.borderWidth&&g.stroke(),g.restore(),k?function(){var a,b,e;return"top right"==k+""?(e=[p.dimensions.width-p.options.closeButtonOffset[0],p.options.closeButtonOffset[1]],a=[e[0]+l,e[1]-l]):(e=[p.options.closeButtonOffset[0],p.options.closeButtonOffset[1]],a=[e[0]-l,e[1]-l]),g.translate(a[0],a[1]),b=
p.options.closeButtonCrossSize/2,g.save(),g.beginPath(),g.strokeStyle=p.options.closeButtonCrossColor,g.lineWidth=p.options.closeButtonCrossLineWidth,g.lineCap="round",g.moveTo(-b,-b),g.lineTo(b,b),g.stroke(),g.beginPath(),g.moveTo(b,-b),g.lineTo(-b,b),g.stroke(),g.restore(),p.adapter.css(p.closeButtonElement,{left:""+(e[0]-b-p.options.closeButtonLinkOverscan)+"px",top:""+(e[1]-b-p.options.closeButtonLinkOverscan)+"px",width:""+(p.options.closeButtonCrossSize+2*p.options.closeButtonLinkOverscan)+
"px",height:""+(p.options.closeButtonCrossSize+2*p.options.closeButtonLinkOverscan)+"px"})}():void 0}},c.prototype._getPathStemMeasures=function(a,b,e){var d,c,h,f,g,m,n;if(f=e/2,h=Math.atan(a/2/b),d=2*h,g=f/Math.sin(d),c=2*g*Math.cos(h),n=f+b-c,0>n)throw Error("Sorry but your stemLength / stemBase ratio is strange.");return m=Math.tan(h)*n*2,{stemLength:n,stemBase:m}},c.prototype._getColor=function(a,b,e,d){var c;if(null==d&&(d=!1),"string"==typeof e)return e;a=d?a.createLinearGradient(0,0,b.width,
0):a.createLinearGradient(0,0,0,b.height);c=b=0;for(d=e.length;d>b;c=++b)c=e[c],a.addColorStop(c[0],c[1]);return a},c.prototype._searchAndActivateCloseButtons=function(){var a,b,e,d;d=this.adapter.findAll(this.container,"."+this["class"].close);b=0;for(e=d.length;e>b;b++)a=d[b],this.hideTriggers.push({element:this.adapter.wrap(a),event:"click"});return this.currentObservers.showing&&this._setupObservers("-showing","showing"),this.currentObservers.visible?this._setupObservers("-visible","visible"):
void 0},c.prototype._activateFirstInput=function(){var a;return a=this.adapter.unwrap(this.adapter.find(this.container,"input, textarea")),null!=a?"function"==typeof a.focus?a.focus():void 0:void 0},c.prototype._followMousePosition=function(){return this.options.fixed?void 0:c._observeMousePosition(this.bound.reposition)},c.prototype._stopFollowingMousePosition=function(){return this.options.fixed?void 0:c._stopObservingMousePosition(this.bound.reposition)},c.prototype._clearShowTimeout=function(){return clearTimeout(this._showTimeoutId)},
c.prototype._clearHideTimeout=function(){return clearTimeout(this._hideTimeoutId)},c.prototype._clearTimeouts=function(){return clearTimeout(this._visibilityStateTimeoutId),this._clearShowTimeout(),this._clearHideTimeout()},c.prototype._triggerElementExists=function(){var a;for(a=this.adapter.unwrap(this.triggerElement);a.parentNode;){if("BODY"===a.parentNode.tagName)return!0;a=a.parentNode}return!1},c.prototype._loadAjax=function(){var a=this;if(!this.loading)return this.loaded=!1,this.loading=!0,
this.adapter.addClass(this.container,this["class"].loading),this.setContent(""),this.debug("Loading content from "+this.options.ajax),this.adapter.ajax({url:this.options.ajax,method:this.options.ajaxMethod,onSuccess:function(b){return a.debug("Loading successful."),a.adapter.removeClass(a.container,a["class"].loading),a.setContent(b)},onError:function(b){var e;return e=a.options.ajaxErrorMessage,a.debug(e,b),a.setContent(e),a.adapter.addClass(a.container,a["class"].ajaxError)},onComplete:function(){return a.adapter.removeClass(a.container,
a["class"].loading),a.loading=!1,a.loaded=!0,a._searchAndActivateCloseButtons(),a._activateFirstInput(),a.reposition()}})},c.prototype._ensureTriggerElement=function(){return this._triggerElementExists()?void 0:(this.deactivate(),this._stopEnsureTriggerElement())},c.prototype._ensureTriggerElementInterval=1E3,c.prototype._startEnsureTriggerElement=function(){var a=this;return this._ensureTriggerElementTimeoutId=setInterval(function(){return a._ensureTriggerElement()},this._ensureTriggerElementInterval)},
c.prototype._stopEnsureTriggerElement=function(){return clearInterval(this._ensureTriggerElementTimeoutId)},c}();vendors=["khtml","ms","o","moz","webkit"];
Opentip.prototype.setCss3Style=function(c,a){var b,e,d,k,h;c=this.adapter.unwrap(c);h=[];for(b in a)__hasProp.call(a,b)&&(e=a[b],null!=c.style[b]?h.push(c.style[b]=e):h.push(function(){var a,g,h;h=[];a=0;for(g=vendors.length;g>a;a++)d=vendors[a],k=""+this.ucfirst(d)+this.ucfirst(b),null!=c.style[k]?h.push(c.style[k]=e):h.push(void 0);return h}.call(this)));return h};Opentip.prototype.defer=function(c){return setTimeout(c,0)};Opentip.prototype.setTimeout=function(c,a){return setTimeout(c,a?1E3*a:0)};
Opentip.prototype.ucfirst=function(c){return null==c?"":c.charAt(0).toUpperCase()+c.slice(1)};Opentip.prototype.dasherize=function(c){return c.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()})};mousePositionObservers=[];mousePosition={x:0,y:0};mouseMoved=function(c){var a,b,e;mousePosition=Opentip.adapter.mousePosition(c);e=[];a=0;for(b=mousePositionObservers.length;b>a;a++)c=mousePositionObservers[a],e.push(c());return e};
Opentip.followMousePosition=function(){return Opentip.adapter.observe(document.body,"mousemove",mouseMoved)};Opentip._observeMousePosition=function(c){return mousePositionObservers.push(c)};Opentip._stopObservingMousePosition=function(c){var a,b,e,d;d=[];b=0;for(e=mousePositionObservers.length;e>b;b++)a=mousePositionObservers[b],a!==c&&d.push(a);return mousePositionObservers=d};
Opentip.Joint=function(){function c(a){null!=a&&(a instanceof Opentip.Joint&&(a+=""),this.set(a))}return c.prototype.set=function(a){return a=a.toLowerCase(),this.setHorizontal(a),this.setVertical(a),this},c.prototype.setHorizontal=function(a){var b,e,d,c;e=["left","center","right"];d=0;for(c=e.length;c>d;d++)b=e[d],~a.indexOf(b)&&(this.horizontal=b.toLowerCase());null==this.horizontal&&(this.horizontal="center");c=[];a=0;for(d=e.length;d>a;a++)b=e[a],c.push(this[b]=this.horizontal===b?b:void 0);
return c},c.prototype.setVertical=function(a){var b,e,d,c;e=["top","middle","bottom"];d=0;for(c=e.length;c>d;d++)b=e[d],~a.indexOf(b)&&(this.vertical=b.toLowerCase());null==this.vertical&&(this.vertical="middle");c=[];a=0;for(d=e.length;d>a;a++)b=e[a],c.push(this[b]=this.vertical===b?b:void 0);return c},c.prototype.eql=function(a){return null!=a&&this.horizontal===a.horizontal&&this.vertical===a.vertical},c.prototype.flip=function(){var a,b;return b=Opentip.position[this.toString(!0)],a=(b+4)%8,this.set(Opentip.positions[a]),
this},c.prototype.toString=function(a){var b,e;return null==a&&(a=!1),e="middle"===this.vertical?"":this.vertical,b="center"===this.horizontal?"":this.horizontal,e&&b&&(b=a?Opentip.prototype.ucfirst(b):" "+b),""+e+b},c}();Opentip.prototype._positionsEqual=function(c,a){return null!=c&&null!=a&&c.left===a.left&&c.top===a.top};Opentip.prototype._dimensionsEqual=function(c,a){return null!=c&&null!=a&&c.width===a.width&&c.height===a.height};
Opentip.prototype.debug=function(){var c;return c=1<=arguments.length?__slice.call(arguments,0):[],Opentip.debug&&null!=("undefined"!=typeof console&&null!==console?console.debug:void 0)?(c.unshift("#"+this.id+" |"),console.debug.apply(console,c)):void 0};
Opentip.findElements=function(){var c,a,b,e,d,k,h,f,g,m;c=Opentip.adapter;g=c.findAll(document.body,"[data-ot]");m=[];h=0;for(f=g.length;f>h;h++){b=g[h];k={};a=c.data(b,"ot");""!==a&&"true"!==a&&"yes"!==a||(a=c.attr(b,"title"),c.attr(b,"title",""));a=a||"";for(e in Opentip.styles.standard)d=c.data(b,"ot"+Opentip.prototype.ucfirst(e)),null!=d&&("yes"===d||"true"===d||"on"===d?d=!0:("no"===d||"false"===d||"off"===d)&&(d=!1),k[e]=d);m.push(new Opentip(b,a,k))}return m};Opentip.version="2.4.6";
Opentip.debug=!1;Opentip.lastId=0;Opentip.lastZIndex=100;Opentip.tips=[];Opentip._abortShowingGroup=function(c,a){var b,e,d,k,h;k=Opentip.tips;h=[];e=0;for(d=k.length;d>e;e++)b=k[e],b!==a&&b.options.group===c?h.push(b._abortShowing()):h.push(void 0);return h};Opentip._hideGroup=function(c,a){var b,e,d,k,h;k=Opentip.tips;h=[];e=0;for(d=k.length;d>e;e++)b=k[e],b!==a&&b.options.group===c?h.push(b.hide()):h.push(void 0);return h};Opentip.adapters={};Opentip.adapter=null;firstAdapter=!0;
Opentip.addAdapter=function(c){return Opentip.adapters[c.name]=c,firstAdapter?(Opentip.adapter=c,c.domReady(Opentip.findElements),c.domReady(Opentip.followMousePosition),firstAdapter=!1):void 0};Opentip.positions="top topRight right bottomRight bottom bottomLeft left topLeft".split(" ");Opentip.position={};_ref=Opentip.positions;i=_i=0;for(_len=_ref.length;_len>_i;i=++_i)position=_ref[i],Opentip.position[position]=i;
Opentip.styles={standard:{"extends":null,title:void 0,escapeTitle:!0,escapeContent:!1,className:"standard",stem:!0,delay:null,hideDelay:0.1,fixed:!1,showOn:"mouseover",hideTrigger:"trigger",hideTriggers:[],hideOn:null,removeElementsOnHide:!1,offset:[0,0],containInViewport:!0,autoOffset:!0,showEffect:"appear",hideEffect:"fade",showEffectDuration:0.3,hideEffectDuration:0.2,stemLength:5,stemBase:8,tipJoint:"top left",target:null,targetJoint:null,cache:!0,ajax:!1,ajaxMethod:"GET",ajaxErrorMessage:"There was a problem downloading the content.",
group:null,style:null,background:"#fff18f",backgroundGradientHorizontal:!1,closeButtonOffset:[5,5],closeButtonRadius:7,closeButtonCrossSize:4,closeButtonCrossColor:"#d2c35b",closeButtonCrossLineWidth:1.5,closeButtonLinkOverscan:6,borderRadius:5,borderWidth:1,borderColor:"#f2e37b",shadow:!0,shadowBlur:10,shadowOffset:[3,3],shadowColor:"rgba(0, 0, 0, 0.1)"},glass:{"extends":"standard",className:"glass",background:[[0,"rgba(252, 252, 252, 0.8)"],[0.5,"rgba(255, 255, 255, 0.8)"],[0.5,"rgba(250, 250, 250, 0.9)"],
[1,"rgba(245, 245, 245, 0.9)"]],borderColor:"#eee",closeButtonCrossColor:"rgba(0, 0, 0, 0.2)",borderRadius:15,closeButtonRadius:10,closeButtonOffset:[8,8]},dark:{"extends":"standard",className:"dark",borderRadius:13,borderColor:"#444",closeButtonCrossColor:"rgba(240, 240, 240, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(30, 30, 30, 0.7)"],[0.5,"rgba(30, 30, 30, 0.8)"],[0.5,"rgba(10, 10, 10, 0.8)"],[1,"rgba(10, 10, 10, 0.9)"]]},alert:{"extends":"standard",className:"alert",
borderRadius:1,borderColor:"#AE0D11",closeButtonCrossColor:"rgba(255, 255, 255, 1)",shadowColor:"rgba(0, 0, 0, 0.3)",shadowOffset:[2,2],background:[[0,"rgba(203, 15, 19, 0.7)"],[0.5,"rgba(203, 15, 19, 0.8)"],[0.5,"rgba(189, 14, 18, 0.8)"],[1,"rgba(179, 14, 17, 0.9)"]]}};Opentip.defaultStyle="standard";"undefined"!=typeof module&&null!==module?module.exports=Opentip:window.Opentip=Opentip;__slice=[].slice;
(function(){var c,a;return Element.addMethods({addTip:function(a,e,d,c){return new Opentip(a,e,d,c)}}),a=function(a){return a instanceof Array||null!=a&&"number"==typeof a.length&&"function"==typeof a.item&&"function"==typeof a.nextNode&&"function"==typeof a.reset?!0:!1},c=function(){function b(){}return b.prototype.name="prototype",b.prototype.domReady=function(a){return document.loaded?a():$(document).observe("dom:loaded",a)},b.prototype.create=function(a){return(new Element("div")).update(a).childElements()},
b.prototype.wrap=function(b){if(a(b)){if(1<b.length)throw Error("Multiple elements provided.");b=this.unwrap(b)}else"string"==typeof b&&(b=$$(b)[0]);return $(b)},b.prototype.unwrap=function(b){return a(b)?b[0]:b},b.prototype.tagName=function(a){return this.unwrap(a).tagName},b.prototype.attr=function(){var a,b,c;return b=arguments[0],a=2<=arguments.length?__slice.call(arguments,1):[],1===a.length?this.wrap(b).readAttribute(a[0]):(c=this.wrap(b)).writeAttribute.apply(c,a)},b.prototype.data=function(a,
b,c){var h;return this.wrap(a),2<arguments.length?a.store(b,c):(h=a.readAttribute("data-"+b.underscore().dasherize()),null!=h?h:a.retrieve(b))},b.prototype.find=function(a,b){return this.wrap(a).select(b)[0]},b.prototype.findAll=function(a,b){return this.wrap(a).select(b)},b.prototype.update=function(a,b,c){return this.wrap(a).update(c?b.escapeHTML():b)},b.prototype.append=function(a,b){return this.wrap(a).insert(this.wrap(b))},b.prototype.remove=function(a){return this.wrap(a).remove()},b.prototype.addClass=
function(a,b){return this.wrap(a).addClassName(b)},b.prototype.removeClass=function(a,b){return this.wrap(a).removeClassName(b)},b.prototype.css=function(a,b){return this.wrap(a).setStyle(b)},b.prototype.dimensions=function(a){return this.wrap(a).getDimensions()},b.prototype.scrollOffset=function(){var a;return a=document.viewport.getScrollOffsets(),[a.left,a.top]},b.prototype.viewportDimensions=function(){return document.viewport.getDimensions()},b.prototype.mousePosition=function(a){return null==
a?null:{x:Event.pointerX(a),y:Event.pointerY(a)}},b.prototype.offset=function(a){var b;return b=this.wrap(a).cumulativeOffset(),{left:b.left,top:b.top}},b.prototype.observe=function(a,b,c){return Event.observe(this.wrap(a),b,c)},b.prototype.stopObserving=function(a,b,c){return Event.stopObserving(this.wrap(a),b,c)},b.prototype.ajax=function(a){var b,c;if(null==a.url)throw Error("No url provided");return new Ajax.Request(a.url,{method:null!=(b=null!=(c=a.method)?c.toUpperCase():void 0)?b:"GET",onSuccess:function(b){return"function"==
typeof a.onSuccess?a.onSuccess(b.responseText):void 0},onFailure:function(b){return"function"==typeof a.onError?a.onError("Server responded with status "+b.status):void 0},onComplete:function(){return"function"==typeof a.onComplete?a.onComplete():void 0}})},b.prototype.clone=function(a){return Object.clone(a)},b.prototype.extend=function(){var a,b,c,h,f;c=arguments[0];b=2<=arguments.length?__slice.call(arguments,1):[];h=0;for(f=b.length;f>h;h++)a=b[h],Object.extend(c,a);return c},b}(),Opentip.addAdapter(new c)})();